======================Perloc======================
create CREATE
view VIEW
Cap ID
as AS
extract EXTRACT
regex REGEX
/[A-Z][a-z]*/ REG
on ON
D ID
. DOT
text ID
as AS
Cap ID
from FROM
Document ID
D ID
; SEMICOLON
create CREATE
view VIEW
Stt ID
as AS
extract EXTRACT
regex REGEX
/Washington|Georgia|Virginia/ REG
on ON
D ID
. DOT
text ID
return RETURN
group GROUP
0 NUM
as AS
Stt ID
from FROM
Document ID
D ID
; SEMICOLON
create CREATE
view VIEW
Loc ID
as AS
extract EXTRACT
pattern PATTERN
( LEFTBRACKET
< LESSTHAN
C ID
. DOT
Cap ID
> GREATERTHAN
) RIGHTBRACKET
/,/ REG
( LEFTBRACKET
< LESSTHAN
S ID
. DOT
Stt ID
> GREATERTHAN
) RIGHTBRACKET
return RETURN
group GROUP
0 NUM
as AS
Loc ID
and AND
group GROUP
1 NUM
as AS
Cap ID
and AND
group GROUP
2 NUM
as AS
Stt ID
from FROM
Cap ID
C ID
, COMMA
Stt ID
S ID
; SEMICOLON
create CREATE
view VIEW
Per ID
as AS
extract EXTRACT
regex REGEX
/[A-Z][a-z]*/ REG
on ON
D ID
. DOT
text ID
return RETURN
group GROUP
0 NUM
as AS
Per ID
from FROM
Document ID
D ID
; SEMICOLON
create CREATE
view VIEW
PerLoc ID
as AS
extract EXTRACT
pattern PATTERN
( LEFTBRACKET
< LESSTHAN
P ID
. DOT
Per ID
> GREATERTHAN
) RIGHTBRACKET
< LESSTHAN
token ID
> GREATERTHAN
{ CURLYLEFTBRACKET
1 NUM
, COMMA
2 NUM
} CURLYRIGHTBRACKET
( LEFTBRACKET
< LESSTHAN
L ID
. DOT
Loc ID
> GREATERTHAN
) RIGHTBRACKET
return RETURN
group GROUP
0 NUM
as AS
PerLoc ID
and AND
group GROUP
1 NUM
as AS
Per ID
and AND
group GROUP
2 NUM
as AS
Loc ID
from FROM
Per ID
P ID
, COMMA
Loc ID
L ID
; SEMICOLON
create CREATE
view VIEW
PerLocOnly ID
as AS
select SELECT
PL ID
. DOT
PerLoc ID
as AS
PerLoc ID
from FROM
PerLoc ID
PL ID
; SEMICOLON
output OUTPUT
view VIEW
Cap ID
; SEMICOLON
output OUTPUT
view VIEW
Stt ID
; SEMICOLON
output OUTPUT
view VIEW
Loc ID
; SEMICOLON
output OUTPUT
view VIEW
Per ID
; SEMICOLON
output OUTPUT
view VIEW
PerLoc ID
; SEMICOLON
output OUTPUT
view VIEW
PerLocOnly ID
; SEMICOLON
======================Revenue=====================
create CREATE
view VIEW
Number ID
as AS
extract EXTRACT
regex REGEX
/[0-9]+(\.[0-9])?/ REG
on ON
D ID
. DOT
text ID
as AS
number ID
from FROM
Document ID
D ID
; SEMICOLON
create CREATE
view VIEW
Unit ID
as AS
extract EXTRACT
regex REGEX
/percent|billion|million|trillion/ REG
on ON
D ID
. DOT
text ID
as AS
unit ID
from FROM
Document ID
D ID
; SEMICOLON
create CREATE
view VIEW
Money ID
as AS
extract EXTRACT
pattern PATTERN
( LEFTBRACKET
/$?/ REG
) RIGHTBRACKET
( LEFTBRACKET
< LESSTHAN
N ID
. DOT
number ID
> GREATERTHAN
) RIGHTBRACKET
( LEFTBRACKET
< LESSTHAN
U ID
. DOT
unit ID
> GREATERTHAN
) RIGHTBRACKET
return RETURN
group GROUP
0 NUM
as AS
money ID
and AND
group GROUP
1 NUM
as AS
dollar ID
and AND
group GROUP
2 NUM
as AS
number ID
and AND
group GROUP
3 NUM
as AS
unit ID
from FROM
Currency ID
C ID
, COMMA
Number ID
N ID
, COMMA
Unit ID
U ID
; SEMICOLON
create CREATE
view VIEW
Revenue ID
as AS
extract EXTRACT
regex REGEX
/revenues|revenue/ REG
on ON
D ID
. DOT
text ID
as AS
revenue ID
from FROM
Document ID
D ID
; SEMICOLON
create CREATE
view VIEW
Division ID
as AS
extract EXTRACT
regex REGEX
/GlobalTechnologyServices|SystemsandTechnology|S&TG|Software|GlobalFinancing|GlobalBusinessServices/ REG
on ON
R ID
. DOT
text ID
as AS
division ID
from FROM
Document ID
R ID
; SEMICOLON
create CREATE
view VIEW
RevenueAndDivision ID
as AS
extract EXTRACT
pattern PATTERN
< LESSTHAN
R ID
. DOT
revenue ID
> GREATERTHAN
< LESSTHAN
Token TOKEN
> GREATERTHAN
{ CURLYLEFTBRACKET
1 NUM
, COMMA
3 NUM
} CURLYRIGHTBRACKET
( LEFTBRACKET
< LESSTHAN
D ID
. DOT
division ID
> GREATERTHAN
) RIGHTBRACKET
< LESSTHAN
Token TOKEN
> GREATERTHAN
{ CURLYLEFTBRACKET
1 NUM
, COMMA
20 NUM
} CURLYRIGHTBRACKET
( LEFTBRACKET
< LESSTHAN
M ID
. DOT
money ID
> GREATERTHAN
) RIGHTBRACKET
return RETURN
group GROUP
0 NUM
as AS
RevenueAndDivision ID
and AND
group GROUP
1 NUM
as AS
Division ID
and AND
group GROUP
2 NUM
as AS
Amount ID
from FROM
Revenue ID
R ID
, COMMA
Division ID
D ID
, COMMA
Money ID
M ID
; SEMICOLON
create CREATE
view VIEW
RevenueAndDivision2 ID
as AS
extract EXTRACT
pattern PATTERN
( LEFTBRACKET
< LESSTHAN
D ID
. DOT
division ID
> GREATERTHAN
) RIGHTBRACKET
< LESSTHAN
Token TOKEN
> GREATERTHAN
{ CURLYLEFTBRACKET
1 NUM
, COMMA
3 NUM
} CURLYRIGHTBRACKET
< LESSTHAN
R ID
. DOT
revenue ID
> GREATERTHAN
< LESSTHAN
Token TOKEN
> GREATERTHAN
{ CURLYLEFTBRACKET
1 NUM
, COMMA
20 NUM
} CURLYRIGHTBRACKET
( LEFTBRACKET
< LESSTHAN
M ID
. DOT
money ID
> GREATERTHAN
) RIGHTBRACKET
return RETURN
group GROUP
0 NUM
as AS
RevenueAndDivision ID
and AND
group GROUP
1 NUM
as AS
Division ID
and AND
group GROUP
2 NUM
as AS
Amount ID
from FROM
Revenue ID
R ID
, COMMA
Division ID
D ID
, COMMA
Money ID
M ID
; SEMICOLON
output OUTPUT
view VIEW
Number ID
; SEMICOLON
output OUTPUT
view VIEW
Unit ID
; SEMICOLON
output OUTPUT
view VIEW
Money ID
; SEMICOLON
output OUTPUT
view VIEW
Revenue ID
; SEMICOLON
output OUTPUT
view VIEW
Division ID
; SEMICOLON
output OUTPUT
view VIEW
RevenueAndDivision ID
; SEMICOLON
output OUTPUT
view VIEW
RevenueAndDivision2 ID
; SEMICOLON
